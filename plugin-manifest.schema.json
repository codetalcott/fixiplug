{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Fixi Plugin Manifest",
  "description": "Schema for describing plugin metadata for the Fixi plugin system.",
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "pattern": "^[A-Za-z][A-Za-z0-9_-]*$",
      "description": "Unique plugin identifier. Must start with a letter and contain only letters, numbers, hyphens or underscores."
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+(?:-[\\w.-]+)?$",
      "description": "Semver version of the plugin.",
      "examples": ["1.0.0", "2.1.3-beta.1"]
    },
    "apiVersion": {
      "type": "string",
      "pattern": "^(?:latest|\\d+\\.\\d+\\.\\d+(?:-[\\w.-]+)?)$",
      "description": "Semver API version this plugin targets, or 'latest'.",
      "examples": ["latest", "2.0.0"]
    },
    "main": {
      "type": "string",
      "description": "Entry‑point file path (relative) where your plugin stub lives, e.g. \"plugins/myPlugin.ts\".",
      "examples": ["plugins/myPlugin.ts"]
    },
    "priority": {
      "type": "integer",
      "minimum": 0,
      "description": "Execution priority; higher values run earlier."
    },
    "dependencies": {
      "type": "array",
      "items": { "type": "string" },
      "description": "List of other plugin names this one depends on."
    },
    "description": {
      "type": "string",
      "description": "Short human‑readable description of the plugin."
    },
    "author": {
      "type": "string",
      "description": "Author or maintainer of the plugin."
    },
    "timeouts": {
      "type": "object",
      "description": "Optional hook timeouts in milliseconds.",
      "patternProperties": {
        "^(initialize|beforeRequest|afterResponse|domMutated|error|destroy)$": {
          "type": "integer",
          "minimum": 0
        }
      },
      "additionalProperties": false,
      "examples": [{ "beforeRequest": 1000, "afterResponse": 500 }]
    },
    "circuitBreaker": {
      "type": "object",
      "description": "Optional circuit breaker settings.",
      "properties": {
        "failureThreshold": { "type": "integer", "minimum": 1 },
        "resetTimeout": { "type": "integer", "minimum": 0 }
      },
      "required": ["failureThreshold", "resetTimeout"],
      "additionalProperties": false,
      "examples": [{ "failureThreshold": 3, "resetTimeout": 60000 }]
    }
  },
  "required": ["name", "version", "apiVersion", "main"],
  "additionalProperties": false
}